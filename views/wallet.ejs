<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Wallet</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Londrina+Outline&display=swap" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Londrina+Outline&display=swap" rel="stylesheet">
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <link rel="stylesheet" href="/css/wallet.css">
    <script src="/js/wallet.js" defer></script>
</head>

<body>

    <%- include('navbar') %>



        <div class="container" style="margin-top: 75px;">
            <div class="main-body pt-5 ">



                <div class="row gutters-sm">
                    <div class="col-md-3 ">
                        <div class="card">
                            <div class="card-body">
                                <div class="d-flex flex-column align-items-center text-center"
                                    style="border-bottom: 1px solid grey;">
                                    <!-- <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="Admin" class="rounded-circle" width="150"> -->
                                    <img src="/images/NO PFP.jpg" alt="Admin" class="rounded-circle" width="150">
                                    <div class="mt-3">
                                        <h4>John Doe</h4>
                                    </div>
                                </div>
                                <div class="d-flex flex-column">
                                    <a href="/my-orders" class="text-decoration-none text-dark">
                                        <div class="d-flex mt-3 align-items-center profile-li">
                                            <i class=" me-3  fs-3 bi bi-box2-heart-fill"></i>

                                            <p>My Orders</p>

                                        </div>
                                    </a>
                                    <a href="" class="text-decoration-none text-dark">
                                        <div class="d-flex mt-3 align-items-center profile-li">
                                            <i class=" me-3 bi bi-person-fill fs-3"></i>

                                            <p>Personal Information</p>

                                        </div>
                                    </a>
                                    <a href="" class="text-decoration-none text-dark">
                                        <div class="d-flex mt-3 align-items-center profile-li">
                                            <i class=" me-3  fs-3 bi bi-building-fill-add"></i>

                                            <p>Manage Addresses</p>

                                        </div>
                                    </a>


                                    <a href="" class="text-decoration-none text-dark">
                                        <div class="d-flex mt-3 align-items-center profile-li">
                                            <i class=" me-3  fs-3 bi bi-heart-fill"></i>
                                            <p>My Wishlist</p>



                                        </div>
                                    </a>

                                    <a href="/my-wallet" class="text-decoration-none text-dark">
                                        <div class="d-flex mt-3 align-items-center profile-li">
                                            <i class="bi me-3  fs-3  bi-wallet-fill"></i>

                                            <p>My Wallet</p>

                                        </div>
                                    </a>

                                    <a href="" class="text-decoration-none text-dark">
                                        <div class="d-flex mt-3 align-items-center profile-li">
                                            <i class=" me-3  fs-3 bi bi-star-half"></i>

                                            <p>My Reviews & Ratings</p>

                                        </div>
                                    </a>


                                </div>


                            </div>
                        </div>

                    </div>
                    <div class="col-md-9 px-5" id="profile-right" style="background-color: white;">



                        <% if (customer.wallet && customer.wallet.isActive ){ %>

                            <content class="transactions-wrapper">
                                <h4 class="d-flex justify-content-between">
                                    Current Balance
                                    <span id="wallet-balance" class="total-balance">
                                        ₹<%= customer.wallet.totalAmount %>
                                    </span>
                                </h4>
                                <div class="transactions  mt-5 pt-4  show">

                                    <% customer.wallet.transactionLog.forEach(log=> { %>

                                        <% if(log.transactionType==='debit' ){ %>

                                            <div class="transaction-item d-flex justify-content-between align-items-center  ">
                                                <div class="transaction-item_details">
                                                    <h6>Wallet Top Up</h6>
                                                    <span class="details">
                                                        <%= log.date %>
                                                    </span>
                                                </div>
                                                <div class="transaction-item_amount">
                                                    <p class="amount text-danger">
                                                        -₹<%= log.amount %>
                                                    </p>
                                                </div>


                                            </div>
                                            <% }else{ %>

                                                <div class="transaction-item  d-flex justify-content-between align-items-center">


                                                    <div class="transaction-item_details">
                                                        <h6>Wallet Top Up</h6>
                                                        <span class="details">
                                                            <%= log.date.toLocaleString() %>

                                                        </span>
                                                    </div>
                                                    <div class="transaction-item_amount">
                                                        <p class="amount text-success">
                                                            + ₹<%= log.amount %>
                                                        </p>
                                                    </div>


                                                </div>

                                                <% } %>




                                                    <% }) %>






                                </div>

                            </content>




                            <% }else { %>

                                <h4>CREATE YOUR WALLET</h4>

                                <form id="createWallet" class="mt-3" method="post">

                                    <div class="row">
                                        <div class="col-md-6 mt-4">
                                            <label for="name" class="form-label fw-bold">WALLET NAME</label>

                                            <input type="text" id="name" class="form-control"
                                                placeholder="Wallet name (Optional)" aria-label="Wallet name">
                                        </div>
                                        <div class="col-md-6 mt-4">
                                            <label for="pin" class="form-label fw-bold">WALLET PIN</label>

                                            <input type="password" id="pin" class="form-control"
                                                placeholder="Wallet PIN" aria-label="Wallet PIN">
                                        </div>
                                        <div class="col-md-6 mt-4">
                                            <label for="amount" class="form-label fw-bold">WALLET AMOUNT</label>


                                            <select class="form-control" id="amount">
                                                <option value="" selected>--Select--</option>
                                                <option value="100">100</option>
                                                <option value="300">300</option>
                                                <option value="500">500</option>
                                                <option value="1000">1000</option>
                                                <option value="1500">1500</option>
                                                <option value="2000">2000</option>
                                                <option value="3000">3000</option>
                                                <option value="4000">4000</option>
                                                <option value="5000">5000</option>
                                                <option value="10000">10000</option>

                                            </select>
                                        </div>


                                    </div>

                                    <input type="hidden" value="<%= customer._id %>" name="" id="userId">


                                    <button id="createWalletBtn" class="btn btn-primary mt-4 ">Create Wallet</button>

                                </form>


                                <% } %>


                    </div>
                </div>

            </div>
        </div>



</body>

</html>